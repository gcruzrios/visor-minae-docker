<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CENIGA-MINAE Visor Geoespacial Leaflet Demo</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet-src.js" crossorigin=""></script>

    <script src="src/Leaflet.draw.js"></script>
    <script src="src/Leaflet.Draw.Event.js"></script>
    <link rel="stylesheet" href="src/leaflet.draw.css"/>

    <script src="src/Toolbar.js"></script>
    <script src="src/Tooltip.js"></script>

    <script src="src/ext/GeometryUtil.js"></script>
    <script src="src/ext/LatLngUtil.js"></script>
    <script src="src/ext/LineUtil.Intersect.js"></script>
    <script src="src/ext/Polygon.Intersect.js"></script>
    <script src="src/ext/Polyline.Intersect.js"></script>
    <script src="src/ext/TouchEvents.js"></script>

    <script src="src/draw/DrawToolbar.js"></script>
    <script src="src/draw/handler/Draw.Feature.js"></script>
    <script src="src/draw/handler/Draw.SimpleShape.js"></script>
    <script src="src/draw/handler/Draw.Polyline.js"></script>
    <script src="src/draw/handler/Draw.Marker.js"></script>
    <script src="src/draw/handler/Draw.Circle.js"></script>
    <script src="src/draw/handler/Draw.CircleMarker.js"></script>
    <script src="src/draw/handler/Draw.Polygon.js"></script>
    <script src="src/draw/handler/Draw.Rectangle.js"></script>


    <script src="src/edit/EditToolbar.js"></script>
    <script src="src/edit/handler/EditToolbar.Edit.js"></script>
    <script src="src/edit/handler/EditToolbar.Delete.js"></script>

    <script src="src/Control.Draw.js"></script>

    <script src="src/edit/handler/Edit.Poly.js"></script>
    <script src="src/edit/handler/Edit.SimpleShape.js"></script>
    <script src="src/edit/handler/Edit.Rectangle.js"></script>
    <script src="src/edit/handler/Edit.Marker.js"></script>
    <script src="src/edit/handler/Edit.CircleMarker.js"></script>
    <script src="src/edit/handler/Edit.Circle.js"></script>




    <style type="text/css">
        html { 
            width: 100%;
            height: 100%; 
            margin: 0; 
            padding: 0;
        }

        body {
            display: flex;
            flex-direction: column;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
        }

        #map { 
            width: 100%; 
            height: 100%; 
        }

        .icon {
            max-width: 70%;
            max-height: 70%;
            margin: 4px;
        }

        .navbar {

        }

        .meta-bar {
            background-color: #ccc;
            margin: 0;

        }

        .logos {
            display: flex;
            background-color: #2b6e99;
        }

        .logo-box {
            padding: 5px;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
        }

        .logo {
            width: 10%;
            align-self: center;
        }

        .meta-bar {
            display: flex;
            justify-content: space-between;
        }

        .metadatos-link {
            text-decoration: none;
            color: black;
        }

        .metadatos-link h2 {
            margin: 0;
            padding: 5px;
        }

        div.legend {
            line-height: 18px;
            color: #555;
            background-color: white;
            padding: 5px;
            opacity: 0.8;
        }

        div.legend h3 {
            margin: 0;
        }

        .legend i {
            width: 18px;
            height: 18px;
            float: left;
            margin-right: 8px;
            opacity: 0.7;
        }

    </style>
</head>

<body>
    <div class="navbar">
        <div class="logos">
            <div class="logo-box">
                <img class="logo icon-geo" src="logos/GEOvisorCENIGA2AMB.png" alt="icon"/>
                <img class="logo icon-minae" src="logos/MINAE-BlancoVF.png" alt="icon"/>
                <img class="logo icon-ceniga" src="logos/CENIGA_LogoBlanco.png" alt="icon"/>
            </div>
        </div>
        <div class="meta-bar">
            <div style="align-self: center;">
                Latitud: <input type="text" name="lat" id="lat"/>
                Longitud: <input type="text" name="lng" id="lng"/>
                <input id="button-play" type="button" value="IR"/>
            </div>
            <a href="http://3.12.93.52:8080/geonetwork" class="metadatos-link">
                <h2>Metadatos</h2>
            </a>
        </div>
    
    
    </div>
   
    <div id="map"></div>


    <link rel="stylesheet" href="dist/L.Control.Layers.Tree.css" crossorigin=""/>
    <script src="dist/L.Control.Layers.Tree.js"></script>

    <script type="text/javascript">
        var center = [9.5, -84];

        // Definiendo las Capas Base de los Mapas

        var osm = L.tileLayer(
            '//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
            {attribution: '© OpenStreetMap contributors'}
        );

        var osmBw = L.tileLayer(
            'http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png',
            {attribution: '© OpenStreetMap contributors'}
        );

        var otopomap = L.tileLayer(
            '//{s}.tile.opentopomap.org/{z}/{x}/{y}.png',
            {attribution: '© OpenStreetMap contributors. OpenTopoMap.org'}
        );

        var googleMap = L.tileLayer(
            'https://mt1.google.com/vt/lyrs=r&x={x}&y={y}&z={z}',
            {attribution: '© GoogleMaps contributors'}
        );

        var googleMapSatellite = L.tileLayer(
            'https://mt1.google.com/vt/lyrs=s&x={x}&y={y}&z={z}',
            {attribution: '© GoogleMaps contributors'}
        );

        var googleMapHybrid = L.tileLayer(
            'https://mt1.google.com/vt/lyrs=y&x={x}&y={y}&z={z}',
            {attribution: '© GoogleMaps contributors'}
        );




        var thunderAttr = {attribution: '© OpenStreetMap contributors. Tiles courtesy of Andy Allan'}
        var transport = L.tileLayer(
            '//{s}.tile.thunderforest.com/transport/{z}/{x}/{y}.png',
            thunderAttr
        );

        var cycle = L.tileLayer(
            '//{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png',
            thunderAttr
        );

        // The tree containing the layers
        var baseTree = [
            {
                label: 'Base Maps',collapsed: true,
                children: [
                    {label: 'OSM', layer: osm, name: 'OpenStreeMap'},
                    {label: 'B&W', layer: osmBw, name: 'OpenStreeMap <b>B&W</b>'},
                    {label: 'OpenTopoMap', layer: otopomap, name: 'Topographic - OSM'},
                    {label: 'GoogleMaps', layer: googleMap, name: 'Google Maps'},
                    {label: 'GoogleMapsSatellite', layer: googleMapSatellite, name: 'Google Maps Satellite'},
                    {label: 'GoogleMaps Hybrid', layer: googleMapHybrid, name: 'Google Maps Hybrid'},

                ]
            },
            {
                label: 'Thunder',collapsed: true,
                children: [
                    {label: 'Cycle', layer: cycle},
                    {label: 'Transport', layer: transport},
                ]
            },
        ];


        








        // The map
        var map = L.map('map', {
            layers: [osm],
            center: center,
            zoom: 8
        });

        //L.control.layers.tree(baseTree).addTo(map);
 
        var granada = L.marker([37.133, -3.636]);
        var malaga = L.marker([36.674, -4.499]);
        var sevilla = L.marker([37.418, -5.893]);

        var overlaysTree = {
            label: 'Algunas ciudades',
            //selectAllCheckbox: 'Un/select all',
            children: [
                {label: '<div id="onlysel">-Mostrar solo selecionadas-</div>'},
                {label: 'France', collapsed: true, children: [
                    {label: 'Lyon', layer: L.marker([45.728, 4.945])},
                    {label: 'Paris', layer: L.marker([48.725, 2.359])},
                    {label: 'Toulouse', layer: L.marker([43.629, 1.364])},
                ]},
                {label: 'Germany', collapsed: true, children: [
                    {label: 'Berlin', layer: L.marker([52.559, 13.287])},
                    {label: 'Cologne', layer: L.marker([50.866, 7.143])},
                    {label: 'Hamburg', layer: L.marker([53.630, 9.988])},
                    {label: 'Munich', layer: L.marker([48.354, 11.786])},
                ]},
                {label: 'Spain', collapsed: true, children: [
                    {label: 'Madrid', layer: L.marker([40.472, -3.561])},
                    {label: 'Granada', layer: granada},
                    {label: 'Málaga', layer: malaga},
                    {label: 'Sevilla', layer: sevilla},
                    {label: 'Barcelona', layer: L.marker([41.297, 2.078])},
                    {label: 'Gerona', layer: L.marker([41.901, 2.760])},
                    
                ]},
                    
            ]
        }
        L.control.layers.tree(baseTree,overlaysTree).addTo(map);

       

        //boton RUN button-play

        var button  = document.getElementById("button-play");
        button.addEventListener('click', run)
        //console.log("Se hizo click en button play");

        function run(){
            var zoom = 12;
            var lat = document.getElementById("lat").value;
            var lng = document.getElementById("lng").value;

            var marker = L.marker([lat, lng],{}).addTo(map);
            map.flyTo([lat, lng], zoom);
        }

        
        
        var osmUrl = 'http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
            osmAttrib = '&copy; <a href="http://openstreetmap.org/copyright">OpenStreetMap</a> contributors',
            osm = L.tileLayer(osmUrl, { maxZoom: 18, attribution: osmAttrib }),
            
            //map = new L.Map('map', { center: new L.LatLng(51.505, -0.04), zoom: 13 }),
            
            drawnItems = L.featureGroup().addTo(map);
            L.control.layers({
            // 'osm': osm.addTo(map),
            //"google": L.tileLayer('http://www.google.cn/maps/vt?lyrs=s@189&gl=cn&x={x}&y={y}&z={z}', {
            // attribution: 'google'
            //})
           }, { 'drawlayer': drawnItems }, { position: 'topleft', collapsed: false }).addTo(map);
        
        map.addControl(new L.Control.Draw({
        edit: {
            featureGroup: drawnItems,
            poly: {
                allowIntersection: false
            }
        },
        draw: {
            polygon: {
                allowIntersection: false,
                showArea: true
            }
        }
    }));

    map.on(L.Draw.Event.CREATED, function (event) {
        var layer = event.layer;

        drawnItems.addLayer(layer);
    });
        

    </script>
</body>
</html>
